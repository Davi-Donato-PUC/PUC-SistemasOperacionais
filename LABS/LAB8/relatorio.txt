Davi Donato   - 2320399
Yuri Trindade - 2321168

# Não consegui testar as ultimas versoes direito, meu wsl2 tava bugado


EX1) ---------------------------------------------------------------------------------------------- >>>

### CÓDIGO ================================= >

# ex1.c ---------------- >
#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <unistd.h>
#include <time.h>

int main() {
    DIR *dir;
    struct dirent *entrada;
    struct stat info;
    char caminho[1024];
    int contador = 0;
    time_t agora = time(NULL);

    dir = opendir(".");
    if (!dir) {
        perror("Erro ao abrir diretório");
        return 1;
    }

    while ((entrada = readdir(dir)) != NULL) {
        if (strcmp(entrada->d_name, ".") == 0 || strcmp(entrada->d_name, "..") == 0)
            continue;

        snprintf(caminho, sizeof(caminho), "./%s", entrada->d_name);

        if (stat(caminho, &info) == 0) {
            contador++;

            double diff = difftime(agora, info.st_mtime) / (60 * 60 * 24);
            int dias = (int) diff;

            printf("%s inode %lu size: %ld age: %d days\n",
                   entrada->d_name,
                   info.st_ino,
                   info.st_size,
                   dias);
        }
    }

    closedir(dir);
    printf("Number of files = %d\n", contador);
    return 0;
}



### TERMINAL ============================== >
$ gcc ex1.c -o ex1
$ ./ex1


### EXPLICAÇÃO ============================= >
O programa abre o diretório atual (.), percorre todos os arquivos e usa stat() para obter informações de cada um.
Para cada arquivo, ele exibe o inode, o tamanho em bytes e a idade em dias, calculada a partir da diferença entre o tempo atual (time(NULL)) e o tempo da última modificação (st_mtime).
Por fim, exibe o total de arquivos encontrados.



EX2) ---------------------------------------------------------------------------------------------- >>>

### CÓDIGO ================================= >

# ex2.c ---------------- >
#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <unistd.h>
#include <time.h>

int main() {
    DIR *dir;
    struct dirent *entrada;
    struct stat info;
    char caminho[1024];
    int contador = 0;
    time_t agora = time(NULL);

    dir = opendir(".");
    if (!dir) {
        perror("Erro ao abrir diretório");
        return 1;
    }

    while ((entrada = readdir(dir)) != NULL) {
        if (strcmp(entrada->d_name, ".") == 0 || strcmp(entrada->d_name, "..") == 0)
            continue;

        snprintf(caminho, sizeof(caminho), "./%s", entrada->d_name);

        if (stat(caminho, &info) == 0) {
            contador++;

            double diff = difftime(agora, info.st_mtime) / (60 * 60 * 24);
            int dias = (int) diff;

            printf("%s inode %lu size: %ld age: %d days links: %lu\n",
                   entrada->d_name,
                   info.st_ino,
                   info.st_size,
                   dias,
                   info.st_nlink);
        }
    }

    closedir(dir);
    printf("Number of files = %d\n", contador);
    return 0;
}


### TERMINAL ============================== >
$ gcc ex2.c -o ex2
$ ./ex2
listaarquivo.c inode 44248571 size: 2322 age: 0 days links: 1
listaarquivo inode 44250424 size: 9492 age: 0 days links: 1
Number of files = 2




### EXPLICAÇÃO ============================= >
Esta versão adiciona a exibição do número de links (st_nlink).
Quando um novo link físico é criado com ln, ambos os arquivos passam a ter o mesmo inode e o número de links aumenta.
Isso mostra que ambos os nomes apontam para o mesmo conteúdo físico no disco.


EX3) ---------------------------------------------------------------------------------------------- >>>

### CÓDIGO ================================= >

# ex3.c ---------------- >
#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <unistd.h>

long long somar_tamanhos(const char *path) {
    struct dirent *entrada;
    struct stat info;
    DIR *dir;
    long long total = 0;
    char caminho[1024];

    dir = opendir(path);
    if (!dir) {
        perror("Erro ao abrir diretório");
        return 0;
    }

    while ((entrada = readdir(dir)) != NULL) {
        if (strcmp(entrada->d_name, ".") == 0 || strcmp(entrada->d_name, "..") == 0)
            continue;

        snprintf(caminho, sizeof(caminho), "%s/%s", path, entrada->d_name);

        if (stat(caminho, &info) == 0) {
            if (S_ISDIR(info.st_mode))
                total += somar_tamanhos(caminho);
            else if (S_ISREG(info.st_mode))
                total += info.st_size;
        }
    }

    closedir(dir);
    return total;
}

int main() {
    char cwd[1024];
    getcwd(cwd, sizeof(cwd));

    long long total = somar_tamanhos(cwd);
    printf("Tamanho total dos arquivos em '%s': %lld bytes\n", cwd, total);

    return 0;
}



### TERMINAL ============================== >
$ gcc ex3.c -o ex3
$ ./ex3
Tamanho total dos arquivos em '/home/dd/SO' : 5932 bytes


### EXPLICAÇÃO ============================= >
O programa percorre recursivamente o diretório corrente e todos os subdiretórios.
Para cada arquivo comum (S_ISREG), soma o tamanho em bytes (st_size).
O resultado final é o total acumulado em todos os diretórios.
A recursão garante que nenhum arquivo seja deixado de fora, mesmo em pastas aninhadas.




EX4) ---------------------------------------------------------------------------------------------- >>>

### CÓDIGO ================================= >

# ex4.c ---------------- >
#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <unistd.h>

void listar_diretorio(const char *path, int nivel) {
    struct dirent *entrada;
    struct stat info;
    DIR *dir;
    char caminho[1024];

    dir = opendir(path);
    if (!dir) {
        perror("Erro ao abrir diretório");
        return;
    }

    while ((entrada = readdir(dir)) != NULL) {
        if (strcmp(entrada->d_name, ".") == 0 || strcmp(entrada->d_name, "..") == 0)
            continue;

        snprintf(caminho, sizeof(caminho), "%s/%s", path, entrada->d_name);
        stat(caminho, &info);

        for (int i = 0; i < nivel; i++) printf("  "); // indentação visual

        if (S_ISDIR(info.st_mode)) {
            printf("[DIR]  %s\n", entrada->d_name);
            listar_diretorio(caminho, nivel + 1);
        } else if (S_ISREG(info.st_mode)) {
            printf("[ARQ]  %s (%ld bytes)\n", entrada->d_name, info.st_size);
        }
    }

    closedir(dir);
}

int main() {
    char cwd[1024];
    getcwd(cwd, sizeof(cwd));

    printf("Listando diretório: %s\n", cwd);
    listar_diretorio(cwd, 0);

    return 0;
}



### TERMINAL ============================== >
$ gcc ex4.c -o ex4
$ ./ex4
Listando diretório: /home/davi/projeto
[DIR]  src
  [ARQ]  main.c (1234 bytes)
  [ARQ]  utils.c (856 bytes)
[DIR]  data
  [ARQ]  dados.txt (2048 bytes)
[ARQ]  README.md (512 bytes)


### EXPLICAÇÃO ============================= >
O programa lista todos os arquivos e diretórios de forma recursiva, mostrando a hierarquia através da indentação.
Para cada item, ele usa stat() para identificar se é um diretório ou arquivo.
A recursão é feita com o parâmetro nivel, que controla o recuo visual para subpastas.
Esse modelo é útil para visualizar a estrutura de diretórios no estilo de árvore (tree).




